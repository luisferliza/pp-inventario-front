<h2 mat-dialog-title>Inversiones</h2>

<form [formGroup]="form" (ngSubmit)="save()">
  <mat-dialog-content>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="36px">
      <mat-form-field fxFlex>
        <mat-label>Tipo de inversión</mat-label>
        <mat-select required formControlName="tipo_Inversion_id">
          <mat-option *ngFor="let tipo of tiposInversion" [value]="tipo.id_tipo_inversion">
            {{tipo.nombre}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field fxFlex>
        <mat-placeholder>No. de certificado</mat-placeholder>
        <input required type="text" formControlName="certificado" matInput>
      </mat-form-field>  
      <mat-form-field fxFlex>
        <mat-placeholder>Referencia PP</mat-placeholder>
        <input required type="text" formControlName="referencia_pp" matInput>
      </mat-form-field>  
    </div>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">
      <mat-form-field fxFlex>
        <mat-placeholder>No. de Cuenta</mat-placeholder>
        <input required type="text" formControlName="cuenta" matInput>
      </mat-form-field>
      <mat-form-field fxFlex>
        <mat-placeholder>Valor de inversión</mat-placeholder>
        <input required type="number" formControlName="monto" matInput>
      </mat-form-field>
      <mat-form-field fxFlex>
        <mat-placeholder>Tasa de interés</mat-placeholder>
        <input required type="number" formControlName="tasa_interes" matInput>
      </mat-form-field>
    </div>


    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">
      <mat-form-field fxFlex>      
        <input matInput [matDatepicker]="fecha_colocacion" placeholder="Fecha de colocación" formControlName="fecha_colocacion" (dateChange)="changeDate()">
        <mat-datepicker-toggle matSuffix [for]="fecha_colocacion"></mat-datepicker-toggle>              
      </mat-form-field>
      <mat-datepicker #fecha_colocacion  ></mat-datepicker> 
      <mat-form-field fxFlex>
        <mat-placeholder>Plazo (Días)</mat-placeholder>
        <input required type="number" formControlName="plazo" (change)="changeDate()" matInput>
      </mat-form-field>
      <mat-form-field fxFlex>      
        <input matInput [matDatepicker]="vencimiento" placeholder="Fecha Vencimiento" formControlName="vencimiento">
        <mat-datepicker-toggle matSuffix [for]="vencimiento"></mat-datepicker-toggle>              
      </mat-form-field>
      <mat-datepicker #vencimiento  ></mat-datepicker> 
    </div>

    
    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">              
      <mat-form-field fxFlex>
        <mat-placeholder>CC Inversión</mat-placeholder>
        <input required type="text" (change)="inversionChanged()" formControlName="cuenta_inversion_codigo" matInput>
      </mat-form-field>      
      <mat-form-field fxFlex>        
        <input required type="text" formControlName="cuenta_inversion_nombre" readonly matInput>
      </mat-form-field>
      <button type="button" (click)="inversion()" mat-icon-button [matMenuTriggerFor]="cuentas"><mat-icon>search</mat-icon></button>
    </div>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">      
      <mat-form-field fxFlex>
        <mat-placeholder>CC Interés por cobrar</mat-placeholder>
        <input required type="text" (change)="provisionChanged()" formControlName="cuenta_provision_codigo" matInput>
      </mat-form-field>      
      <mat-form-field fxFlex>        
        <input required type="text" formControlName="cuenta_provision_nombre" readonly matInput>
      </mat-form-field>
      <button type="button" (click)="provision()" mat-icon-button [matMenuTriggerFor]="cuentas"><mat-icon>search</mat-icon></button>
    </div>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">      
      <mat-form-field fxFlex>
        <mat-placeholder>CC Interes producto</mat-placeholder>
        <input required type="text" (change)="interesChanged()" formControlName="cuenta_interes_codigo" matInput>
      </mat-form-field>      
      <mat-form-field fxFlex>        
        <input required type="text" formControlName="cuenta_interes_nombre" readonly matInput>
      </mat-form-field>
      <button type="button" (click)="interes()" mat-icon-button [matMenuTriggerFor]="cuentas"><mat-icon>search</mat-icon></button>
    </div>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">
      <mat-form-field fxFlex>
        <mat-label>Banco</mat-label>
        <mat-select required formControlName="banco_id" >
          <mat-option *ngFor="let banco of bancos" [value]="banco.id_banco">
            {{banco.nombre}}
          </mat-option>
        </mat-select>
      </mat-form-field>  
      <mat-form-field fxFlex>
        <mat-placeholder>Acta JAPP</mat-placeholder>
        <input required type="text" formControlName="acta_japp" matInput>
      </mat-form-field>

      <mat-form-field fxFlex>      
        <input matInput [matDatepicker]="fecha_acta" placeholder="Fecha Acta JAPP" formControlName="fecha_acta">
        <mat-datepicker-toggle matSuffix [for]="fecha_acta"></mat-datepicker-toggle>              
      </mat-form-field>
      <mat-datepicker #fecha_acta></mat-datepicker>       
    </div>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">
      <mat-form-field fxFlex>
        <mat-label>Forma de pago</mat-label>
        <mat-select required formControlName="periodo_pago" (selectionChange)=ChangePayDate()>
          <mat-option *ngFor="let periodo of periodos" [value]="periodo">
            {{periodo}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex>      
        <input matInput [matDatepicker]="fecha_pago" placeholder="Primera fecha pago" formControlName="fecha_pago">
        <mat-datepicker-toggle matSuffix [for]="fecha_pago"></mat-datepicker-toggle>              
      </mat-form-field>
      <mat-datepicker #fecha_pago></mat-datepicker>  
      <mat-form-field fxFlex>
        <mat-placeholder>Días Anuales</mat-placeholder>
        <input required type="number" formControlName="dias_anuales" matInput>
      </mat-form-field>
    </div>


    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">      
      <mat-form-field fxFlex>
        <mat-label>Estado de inversión</mat-label>
        <mat-select required formControlName="estado_inversion">
          <mat-option *ngFor="let estado of estados" [value]="estado.id_estado">
            {{estado.nombre}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div style="padding-top: 3%; padding-right: 4.75%;">
        <mat-checkbox [checked]="true" color="primary" formControlName="reinversion">¿Reinversión?</mat-checkbox>
      </div>              
    </div>

    <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="24px">
      <mat-form-field fxFlex>
        <mat-placeholder>Observación</mat-placeholder>
        <textarea type="text" formControlName="observacion" maxlength="500" matInput></textarea>
      </mat-form-field>        
      <div style="padding-top: 4.5%;">
        <mat-checkbox [checked]="true" color="primary" formControlName="calculo_especial">¿Cálculo especial?</mat-checkbox>
      </div>
    </div>

    <!---->
    <mat-menu #cuentas="matMenu">
      <button *ngIf="createCategory(0)" mat-menu-item [matMenuTriggerFor]="cat1">{{getCategoryName(0)}}</button>
      <button *ngIf="createCategory(1)" mat-menu-item [matMenuTriggerFor]="cat2">{{getCategoryName(1)}}</button>
      <button *ngIf="createCategory(2)" mat-menu-item [matMenuTriggerFor]="cat3">{{getCategoryName(2)}}</button>
      <button *ngIf="createCategory(3)" mat-menu-item [matMenuTriggerFor]="cat4">{{getCategoryName(3)}}</button>
      <button *ngIf="createCategory(4)" mat-menu-item [matMenuTriggerFor]="cat5">{{getCategoryName(4)}}</button>
      <button *ngIf="createCategory(5)" mat-menu-item [matMenuTriggerFor]="cat6">{{getCategoryName(5)}}</button>
      <button *ngIf="createCategory(6)" mat-menu-item [matMenuTriggerFor]="cat7">{{getCategoryName(6)}}</button>
      <button *ngIf="createCategory(7)" mat-menu-item [matMenuTriggerFor]="cat8">{{getCategoryName(7)}}</button>
      <button *ngIf="createCategory(8)" mat-menu-item [matMenuTriggerFor]="cat9">{{getCategoryName(8)}}</button>
      <button *ngIf="createCategory(9)" mat-menu-item [matMenuTriggerFor]="cat10">{{getCategoryName(9)}}</button>      
    </mat-menu>
    
    <mat-menu #cat1="matMenu"><button *ngFor="let cuenta of getCuentas(0)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }}</button></mat-menu>
    <mat-menu #cat2="matMenu"><button *ngFor="let cuenta of getCuentas(1)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }}</button></mat-menu>
    <mat-menu #cat3="matMenu"><button *ngFor="let cuenta of getCuentas(2)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat4="matMenu"><button *ngFor="let cuenta of getCuentas(3)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat5="matMenu"><button *ngFor="let cuenta of getCuentas(4)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat6="matMenu"><button *ngFor="let cuenta of getCuentas(5)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat7="matMenu"><button *ngFor="let cuenta of getCuentas(6)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat8="matMenu"><button *ngFor="let cuenta of getCuentas(7)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat9="matMenu"><button *ngFor="let cuenta of getCuentas(8)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>
    <mat-menu #cat10="matMenu"><button *ngFor="let cuenta of getCuentas(9)" type="button" mat-menu-item (click)="setCuenta(cuenta.numero)"> {{ cuenta.nombre }} </button></mat-menu>       
    <!---->
     
  </mat-dialog-content>

  <mat-dialog-actions fxLayout="row" fxLayoutAlign="end center">
    <button *ngIf="isCreateMode()" mat-button [disabled]="!form.valid">Crear inversion</button>
    <button *ngIf="isUpdateMode()" mat-button [disabled]="!form.valid">Actualizar inversión</button>    
  </mat-dialog-actions>
</form>